!function(a){"use strict";function b(a,b,c,e){var f=b&&b.prototype instanceof d?b:d,g=Object.create(f.prototype),h=new m(e||[]);return g._invoke=i(a,c,h),g}function c(a,b,c){try{return{type:"normal",arg:a.call(b,c)}}catch(a){return{type:"throw",arg:a}}}function d(){}function e(){}function f(){}function g(a){["next","throw","return"].forEach(function(b){a[b]=function(a){return this._invoke(b,a)}})}function h(a){function b(d,e,f,g){var h=c(a[d],a,e);if("throw"===h.type)g(h.arg);else{var i=h.arg,j=i.value;return j&&"object"===typeof j&&q.call(j,"__await")?Promise.resolve(j.__await).then(function(a){b("next",a,f,g)},function(a){b("throw",a,f,g)}):Promise.resolve(j).then(function(a){i.value=a,f(i)},g)}}function d(a,c){function d(){return new Promise(function(d,e){b(a,c,d,e)})}return e=e?e.then(d,d):d()}var e;this._invoke=d}function i(a,b,d){var e="suspendedStart";return function(f,g){if(e==="executing")throw new Error("Generator is already running");if("completed"===e){if("throw"===f)throw g;return o()}for(d.method=f,d.arg=g;;){var h=d.delegate;if(h){var i=j(h,d);if(i){if(i===x)continue;return i}}if("next"===d.method)d.sent=d._sent=d.arg;else if("throw"===d.method){if("suspendedStart"===e)throw e="completed",d.arg;d.dispatchException(d.arg)}else"return"===d.method&&d.abrupt("return",d.arg);e="executing";var k=c(a,b,d);if("normal"===k.type){if(e=d.done?"completed":"suspendedYield",k.arg===x)continue;return{value:k.arg,done:d.done}}"throw"===k.type&&(e="completed",d.method="throw",d.arg=k.arg)}}}function j(a,b){var d=a.iterator[b.method];if(void 0===d){if(b.delegate=null,"throw"===b.method){if(a.iterator.return&&(b.method="return",b.arg=void 0,j(a,b),"throw"===b.method))return x;b.method="throw",b.arg=new TypeError("The iterator does not provide a 'throw' method")}return x}var e=c(d,a.iterator,b.arg);if("throw"===e.type)return b.method="throw",b.arg=e.arg,b.delegate=null,x;var f=e.arg;if(!f)return b.method="throw",b.arg=new TypeError("iterator result is not an object"),b.delegate=null,x;if(f.done)b[a.resultName]=f.value,b.next=a.nextLoc,"return"!==b.method&&(b.method="next",b.arg=void 0);else return f;return b.delegate=null,x}function k(a){var b={tryLoc:a[0]};1 in a&&(b.catchLoc=a[1]),2 in a&&(b.finallyLoc=a[2],b.afterLoc=a[3]),this.tryEntries.push(b)}function l(a){var b=a.completion||{};b.type="normal",delete b.arg,a.completion=b}function m(a){this.tryEntries=[{tryLoc:"root"}],a.forEach(k,this),this.reset(!0)}function n(a){if(a){var b=a[s];if(b)return b.call(a);if("function"===typeof a.next)return a;if(!isNaN(a.length)){var c=-1,d=function b(){for(;++c<a.length;)if(q.call(a,c))return b.value=a[c],b.done=!1,b;return b.value=void 0,b.done=!0,b};return d.next=d}}return{next:o}}function o(){return{value:void 0,done:!0}}var p=Object.prototype,q=p.hasOwnProperty,r="function"===typeof Symbol?Symbol:{},s=r.iterator||"@@iterator",t=r.asyncIterator||"@@asyncIterator",u=r.toStringTag||"@@toStringTag",v="object"===typeof module,w=a.regeneratorRuntime;if(w)return void(v&&(module.exports=w));w=a.regeneratorRuntime=v?module.exports:{},w.wrap=b;var x={},y={};y[s]=function(){return this};var z=Object.getPrototypeOf,A=z&&z(z(n([])));A&&A!==p&&q.call(A,s)&&(y=A);var B=f.prototype=d.prototype=Object.create(y);e.prototype=B.constructor=f,f.constructor=e,f[u]=e.displayName="GeneratorFunction",w.isGeneratorFunction=function(a){var b="function"===typeof a&&a.constructor;return!!b&&(b===e||"GeneratorFunction"===(b.displayName||b.name))},w.mark=function(a){return Object.setPrototypeOf?Object.setPrototypeOf(a,f):(a.__proto__=f,!(u in a)&&(a[u]="GeneratorFunction")),a.prototype=Object.create(B),a},w.awrap=function(a){return{__await:a}},g(h.prototype),h.prototype[t]=function(){return this},w.AsyncIterator=h,w.async=function(a,c,d,e){var f=new h(b(a,c,d,e));return w.isGeneratorFunction(c)?f:f.next().then(function(a){return a.done?a.value:f.next()})},g(B),B[u]="Generator",B[s]=function(){return this},B.toString=function(){return"[object Generator]"},w.keys=function(a){var b=[];for(var c in a)b.push(c);return b.reverse(),function c(){for(;b.length;){var d=b.pop();if(d in a)return c.value=d,c.done=!1,c}return c.done=!0,c}},w.values=n,m.prototype={constructor:m,reset:function(a){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(l),!a)for(var b in this)"t"===b.charAt(0)&&q.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=void 0)},stop:function(){this.done=!0;var a=this.tryEntries[0],b=a.completion;if("throw"===b.type)throw b.arg;return this.rval},dispatchException:function(a){function b(b,d){return f.type="throw",f.arg=a,c.next=b,d&&(c.method="next",c.arg=void 0),!!d}if(this.done)throw a;for(var c=this,d=this.tryEntries.length-1;0<=d;--d){var e=this.tryEntries[d],f=e.completion;if("root"===e.tryLoc)return b("end");if(e.tryLoc<=this.prev){var g=q.call(e,"catchLoc"),h=q.call(e,"finallyLoc");if(g&&h){if(this.prev<e.catchLoc)return b(e.catchLoc,!0);if(this.prev<e.finallyLoc)return b(e.finallyLoc)}else if(g){if(this.prev<e.catchLoc)return b(e.catchLoc,!0);}else if(!h)throw new Error("try statement without catch or finally");else if(this.prev<e.finallyLoc)return b(e.finallyLoc)}}},abrupt:function(a,b){for(var c,d=this.tryEntries.length-1;0<=d;--d)if(c=this.tryEntries[d],c.tryLoc<=this.prev&&q.call(c,"finallyLoc")&&this.prev<c.finallyLoc){var e=c;break}e&&("break"===a||"continue"===a)&&e.tryLoc<=b&&b<=e.finallyLoc&&(e=null);var f=e?e.completion:{};return f.type=a,f.arg=b,e?(this.method="next",this.next=e.finallyLoc,x):this.complete(f)},complete:function(a,b){if("throw"===a.type)throw a.arg;return"break"===a.type||"continue"===a.type?this.next=a.arg:"return"===a.type?(this.rval=this.arg=a.arg,this.method="return",this.next="end"):"normal"===a.type&&b&&(this.next=b),x},finish:function(a){for(var b,c=this.tryEntries.length-1;0<=c;--c)if(b=this.tryEntries[c],b.finallyLoc===a)return this.complete(b.completion,b.afterLoc),l(b),x},catch:function(a){for(var b,c=this.tryEntries.length-1;0<=c;--c)if(b=this.tryEntries[c],b.tryLoc===a){var d=b.completion;if("throw"===d.type){var e=d.arg;l(b)}return e}throw new Error("illegal catch attempt")},delegateYield:function(a,b,c){return this.delegate={iterator:n(a),resultName:b,nextLoc:c},"next"===this.method&&(this.arg=void 0),x}}}(function(){return this}()||Function("return this")());var NamedRouting=function(){function NamedRouting(){babelHelpers.classCallCheck(this,NamedRouting)}babelHelpers.createClass(NamedRouting,null,[{key:"addNamedItem",value:function addNamedItem(name,item){if(item===void 0){item=name;name=""}if(!name){name=item.getName()}if(name){if(NamedRouting.registry[name]){throw"Error adding named item ".concat(name,", item with that name already registered")}NamedRouting.registry[name]=item;var assignment=NamedRouting.getAssignment(name);if(assignment&&item.canLeave(assignment.url)){item.processNamedUrl(assignment.url)}}}},{key:"removeNamedItem",value:function removeNamedItem(name){if(NamedRouting.registry[name]){delete NamedRouting.registry[name]}}},{key:"getNamedItem",value:function getNamedItem(name){return NamedRouting.registry[name]}},{key:"consumeAssignement",value:function consumeAssignement(name){var assignment=NamedRouting.getAssignment(name);if(assignment){NamedRouting.removeAssignment(name)}return assignment}},{key:"getAssignment",value:function getAssignment(name){return NamedRouting.assignments[name]}},{key:"addAssignment",value:function addAssignment(name,url){var lastAssignment=NamedRouting.assignments[name];NamedRouting.assignments[name]={name:name,url:url};var namedItem=NamedRouting.getNamedItem(name);if(namedItem){if(!1===namedItem.canLeave(url)){NamedRouting.assignments[name]=lastAssignment;return!1}namedItem.processNamedUrl(url)}}},{key:"removeAssignment",value:function removeAssignment(name){if(NamedRouting.assignments[name]){delete NamedRouting.assignments[name];return!0}return!1}},{key:"generateNamedItemsUrl",value:function generateNamedItemsUrl(){var url="",assignments=NamedRouting.assignments;for(var itemName in assignments){if(url.length){url+="::"}url+=NamedRouting.generateUrlFragment(assignments[itemName])}return url}},{key:"generateUrlFragment",value:function generateUrlFragment(assignment){return"(".concat(assignment.name,":").concat(assignment.url.replace(/\./g,"_dot_"),")")}},{key:"parseNamedItem",value:function parseNamedItem(url,supressAdding){if("/"===url[0]){url=url.substr(1)}if("("===url[0]){url=url.substr(1,url.length-2)}var match=url.match(/^\/?\(?([\w_-]+)\:(.*)\)?/);if(match){var urlEscaped=match[2].replace(/_dot_/g,"."),routeCancelled=!1;if(!0!==supressAdding){if(!1===NamedRouting.addAssignment(match[1],urlEscaped)){routeCancelled=!0}}return{name:match[1],url:match[2],urlEscaped:urlEscaped,cancelled:routeCancelled}}return null}},{key:"canLeave",value:function canLeave(newRoute){var canLeaveEvent=new CustomEvent("onRouteLeave",{bubbles:!0,cancelable:!0,composed:!0,detail:{route:newRoute}});this.dispatchEvent(canLeaveEvent);return!canLeaveEvent.defaultPrevented}}]);return NamedRouting}();NamedRouting.registry={};NamedRouting.assignments={};var namedRouting={NamedRouting:NamedRouting},RouterElement=function(_HTMLElement){babelHelpers.inherits(RouterElement,_HTMLElement);babelHelpers.createClass(RouterElement,[{key:"disconnectedCallback",value:function disconnectedCallback(){RouterElement.removeRouter.call(this._parentRouter,this);this.removeEventListener("routerAdded",this.addRouter,!1);if(this.getName()){NamedRouting.removeNamedItem(this.getName())}}},{key:"connectedCallback",value:function connectedCallback(){if(!this.created){this.created=!0;var baseURI=document.baseURI;if(baseURI===void 0){var baseTags=document.getElementsByTagName("base");baseURI=baseTags.length?baseTags[0].href:document.URL;document.baseURI=baseURI}this._routers=[];RouterElement.initialize()}if(this.isConnected){var routerAddedEvent=new CustomEvent("onRouterAdded",{bubbles:!0,cancelable:!0,composed:!0,detail:{router:this}});this.dispatchEvent(routerAddedEvent);this._parentRouter=routerAddedEvent.detail.parentRouter;this.addEventListener("onRouterAdded",this.handlerAddRouter=RouterElement.handlerAddRouter.bind(this),!1);NamedRouting.addNamedItem(this)}}}],[{key:"handlerAddRouter",value:function handlerAddRouter(event){RouterElement.addRouter.call(this,event.detail.router);event.stopPropagation();event.detail.parentRouter=this}},{key:"handlerRouterLinksAdded",value:function handlerRouterLinksAdded(event){if(event.detail.links){RouterElement.registerLinks(event.detail.links)}}},{key:"handlerNavigate",value:function handlerNavigate(event){if(event.detail.href){RouterElement.navigate(event.detail.href)}}},{key:"addRouter",value:function addRouter(router){this._routers.push(router)}},{key:"removeRouter",value:function removeRouter(routerElement){var routerIndex=this._routers.indexOf(routerElement);if(-1<routerIndex){this._routers.splice(routerIndex,1)}}},{key:"changeHash",value:function changeHash(){var hash=RouterElement._getHash();RouterElement.dispatch(_changeHash(hash))}},{key:"changeUrl",value:function changeUrl(){var hash=RouterElement._getHash(),path=window.decodeURIComponent(window.location.pathname),query=window.location.search.substring(1),oldRoute=RouterElement._route;if(!RouterElement._initialized){return!1}if(oldRoute.path===path&&oldRoute.query===query&&oldRoute.hash===hash){return!1}var newUrl=RouterElement._getUrl(window.location);RouterElement.dispatch(newUrl)}},{key:"navigate",value:function navigate(navigationSource){var event=null,anchor=null;if(babelHelpers.instanceof(navigationSource,Event)){event=navigationSource;if(event.defaultPrevented){return}}else if("string"!==typeof navigationSource){anchor=navigationSource}var href=RouterElement._getSameOriginLinkHref(navigationSource);if(null===href){return}if(!href){var target=event&&event.target||anchor;if(target){target.dispatchEvent(new CustomEvent("onRouteNotHandled",{bubbles:!0,composed:!0,detail:{href:href}}))}return}event&&event.preventDefault();if(href===window.location.href){return}var url=new URL(href),newUrl=RouterElement._getUrl(url);RouterElement.dispatch(newUrl)}},{key:"dispatch",value:function dispatch(url){var basePath=RouterElement.baseUrlSansHost(),shortUrl=url.substr(basePath.length);RouterElement._route={url:shortUrl};if(RouterElement._activeRouters.length&&!1===RouterElement._activeRouters.every(function(r){return r.route.canLeave(RouterElement._route)})){RouterElement._activeRouters[0].router.dispatchEvent(new CustomEvent("onRouteCancelled",{bubbles:!0,composed:!0,detail:{shortUrl:shortUrl}}));return}RouterElement._activeRouters=[];if(RouterElement.performMatchOnRouters(shortUrl,RouterElement._routers)){RouterElement.updateHistory(url)}}},{key:"updateHistory",value:function updateHistory(href){var urlState=RouterElement.getUrlState(),url=urlState;if(2===url.length){url=href}else{url=document.baseURI+url}var fullNewUrl=new URL(url,window.location.protocol+"//"+window.location.host).href,oldRoute=RouterElement._route,now=window.performance.now(),shouldReplace=oldRoute._lastChangedAt+RouterElement._dwellTime>now;oldRoute._lastChangedAt=now;if(shouldReplace){window.history.replaceState({},"",fullNewUrl)}else{window.history.pushState({},"",fullNewUrl)}RouterElement.updateAnchorsStatus(urlState)}},{key:"updateAnchorsStatus",value:function updateAnchorsStatus(url){url=url||RouterElement.getUrlState();for(var currentAnchors=RouterElement._anchors,nextAnchors=[],i=0,iLen=currentAnchors.length;i<iLen;i++){if(!0===currentAnchors[i].a.isConnected){var link=currentAnchors[i];nextAnchors[nextAnchors.length]=link;link.a.classList.remove(link.a.activeClassName||"active")}}var urlFragments=url.split("::");nextUrlFragment:for(var j=0,jLen=urlFragments.length;j<jLen;j++){var urlFragment=urlFragments[j],urlFragNamedItemMatch=NamedRouting.parseNamedItem(urlFragment,!0);nextLink:for(var _i=0,_iLen=nextAnchors.length,_link;_i<_iLen;_i++){_link=nextAnchors[_i];if(_link&&_link.a.classList.contains(_link.a.activeClassName||"active")){continue nextLink}if(_link){if(_link.routerMatches){var named=_link.routerMatches.named,routes=_link.routerMatches.routes;if(urlFragNamedItemMatch){for(var k=0,kLen=named.length;k<kLen;k++){if(named[k].name==urlFragNamedItemMatch.name){if(named[k].url==urlFragNamedItemMatch.urlEscaped){_link.a.classList.add(_link.a.activeClassName||"active");_link=null;continue nextLink}else if(0===urlFragNamedItemMatch.urlEscaped.indexOf(named[k].url)){_link.a.classList.add(_link.a.activeClassName||"active");_link=null;continue nextLink}}}}for(var _k=0,_kLen=routes.length;_k<_kLen;_k++){if(urlFragment==routes[_k]){_link.a.classList.add(_link.a.activeClassName||"active");_link=null;continue nextLink}else if(0===routes[_k].indexOf(urlFragment)){_link.a.classList.add(_link.a.activeClassName||"active");_link=null;continue nextLink}}}}}}window.dispatchEvent(new CustomEvent("onLinkActiveStatusUpdated",{bubbles:!0,composed:!0,detail:{links:nextAnchors}}));return null}},{key:"getUrlState",value:function getUrlState(){var url=NamedRouting.generateNamedItemsUrl();if(RouterElement._routers){for(var i=0,iLen=RouterElement._routers.length,nextFrag;i<iLen;i++){nextFrag=RouterElement._routers[i].generateUrlFragment();if(nextFrag){if(url.length){url+="::"}url+=nextFrag}}}return url}},{key:"performMatchOnRouters",value:function performMatchOnRouters(url,routers){if("("===url[0]){url=url.substr(1,url.length-2)}for(var urls=RouterElement.splitUrlIntoRouters(url),urlsWithoutNamedOutlets=[],_i2=0,iLen=urls.length,match;_i2<iLen;_i2++){match=NamedRouting.parseNamedItem(urls[_i2]);if(match&&match.cancelled){return!1}if(!match){urlsWithoutNamedOutlets.push(urls[_i2])}}for(var i=0,_iLen2=routers.length,router;i<_iLen2;i++){router=routers[i];if(urlsWithoutNamedOutlets[i]){router.performMatchOnRouter(urlsWithoutNamedOutlets[i]||"")}}return!0}},{key:"splitUrlIntoRouters",value:function splitUrlIntoRouters(url){for(var urls=[],skip=0,i=0,lastI=i,iLen=url.length,char;i<iLen;i++){char=url[i];if("("===char){skip++}else if(")"===char){skip--}else if(":"===char&&":"===url[i+1]&&0===skip){urls.push(url.substring(lastI+(":"===url[lastI]?1:0),i));i++;lastI=i}}if("("===url[lastI]||")"===url[lastI]||":"===url[lastI]){lastI++}if(i>lastI){urls.push(url.substr(lastI))}for(var j=0,jLen=urls.length;j<jLen;j++){if("/"===urls[j][0]){urls[j]=urls[j].substr(1)}if("("===urls[j][0]&&")"===urls[j][urls[j].length-1]){urls[j]=urls[j].substr(1,urls[j].length-2)}}return urls}},{key:"registerLinks",value:function registerLinks(links,activeClassName){for(var currentAnchors=RouterElement._anchors,nextAnchors=[],i=0,iLen=currentAnchors.length;i<iLen;i++){if(!0===currentAnchors[i].a.isConnected){nextAnchors[nextAnchors.length]=currentAnchors[i]}}for(var _i3=0,_iLen3=links.length;_i3<_iLen3;_i3++){if(links[_i3].href){var matches=RouterElement.sanitizeLinkHref(links[_i3]);if(matches){nextAnchors[nextAnchors.length]={a:links[_i3],activeClassName:activeClassName,routerMatches:matches}}}}RouterElement._anchors=nextAnchors;RouterElement.updateAnchorsStatus()}},{key:"sanitizeLinkHref",value:function sanitizeLinkHref(linkElement){var href=RouterElement._getSameOriginLinkHref(linkElement),url=new URL(href),hash=RouterElement._getHash(),path=window.decodeURIComponent(url.pathname),query=url.search.substring(1),basePathLength=RouterElement.baseUrlSansHost().length;url=path.substr(basePathLength);if("("===url[0]){url=url.substr(1,url.length-2)}for(var urls=RouterElement.splitUrlIntoRouters(url),namedMatches=[],routerMatches=[],i=0,iLen=urls.length,namedMatch;i<iLen;i++){namedMatch=NamedRouting.parseNamedItem(urls[i],!0);if(namedMatch){namedMatches.push(namedMatch)}else{routerMatches.push(urls[i])}}return{named:namedMatches,routes:routerMatches}}}]);function RouterElement(){var _this;babelHelpers.classCallCheck(this,RouterElement);_this=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(RouterElement).call(this));_this.canLeave=NamedRouting.canLeave.bind(babelHelpers.assertThisInitialized(babelHelpers.assertThisInitialized(_this)));return _this}babelHelpers.createClass(RouterElement,[{key:"getName",value:function getName(){if(this.routerName===void 0){this.routerName=this.getAttribute("name")}return this.routerName}},{key:"getCurrentMatch",value:function getCurrentMatch(){if(!this._currentMatch&&this._parentRouter._currentMatch){this._currentMatch={remainder:this._parentRouter._currentMatch.remainder};var remainder=this._currentMatch.remainder;if(remainder&&"("===remainder[0]){remainder=RouterElement.splitUrlIntoRouters(remainder.substring(1,remainder.length-2));this._currentMatch.remainder=remainder.shift()}this._currentMatch.url=this._currentMatch.remainder}return this._currentMatch}},{key:"addRoute",value:function addRoute(routeElement){console.log("route added: "+routeElement.getAttribute("path"));if(!this.hasMatch){var currentMatch=this.getCurrentMatch();if(currentMatch){if(currentMatch.remainder){this.performMatchOnRoute(currentMatch.remainder,routeElement)}}else{this.performMatchOnRoute(RouterElement._route.url,routeElement)}}}},{key:"processNamedUrl",value:function processNamedUrl(url){return this.performMatchOnRouter(url)}},{key:"performMatchOnRouter",value:function performMatchOnRouter(url){this.hasMatch=!1;this._currentMatch={remainder:url};for(var routeElements=this._getRouterElements("a-route"),outletElement=this._getRouterElements("an-outlet")[0],match=null,i=0,iLen=routeElements.length,routeElement;i<iLen;i++){routeElement=routeElements[i];match=this.performMatchOnRoute(url,routeElement);if(null!=match){console.log("route matched -> ",routeElement.getAttribute("path"));break}}if(null===match){if(outletElement.renderContent){outletElement.renderContent("No matching route for url "+url+" \r\nTo replace this message add a 404 catch all route\r\n <a-route path='*'><template>catach all - NotFound</template></a-route>");console&&console.error&&console.error("404 - Route not found for url "+url)}return null}return match}},{key:"performMatchOnRoute",value:function performMatchOnRoute(url,routeElement){if(!routeElement.match){return null}var match=routeElement.match(url)||null;if(null!=match){if(match.redirect){return this.performMatchOnRouter(match.redirect)}var activeRouters=RouterElement._activeRouters;activeRouters.push({route:routeElement,router:this,match:match});this._currentMatch=match;if(match.useCache){if(this._routers&&match.remainder){RouterElement.performMatchOnRouters(match.remainder,this._routers)}}else{var outletElement=this._getRouterElements("an-outlet")[0];routeElement.getContent(match.data).then(function(content){return outletElement.renderContent(content)})}this.postProcessMatch()}return match}},{key:"postProcessMatch",value:function postProcessMatch(){this.hasMatch=!0;if(this._parentRouter._currentMatch){var parentMatch=this._parentRouter._currentMatch,remainder=parentMatch.remainder;if(remainder&&"("===remainder[0]){remainder=remainder.substring(1,remainder.length-2)}remainder=RouterElement.splitUrlIntoRouters(remainder);remainder.shift();if(1<remainder.length){this._parentRouter._currentMatch.remainder="("+remainder.join("::")+")"}else if(1===remainder.length){this._parentRouter._currentMatch.remainder=remainder[0]}else{this._parentRouter._currentMatch.remainder=""}}}},{key:"generateUrlFragment",value:function generateUrlFragment(){var match=this._currentMatch;if(!match){return""}var urlFrag=match.url;if(match.remainder){urlFrag+="/"+match.remainder}if(this._routers&&this._routers.length){urlFrag+="/(";for(var i=0,iLen=this._routers.length;i<iLen;i++){if(0<i){urlFrag+="::"}urlFrag+=this._routers[i].generateUrlFragment()}urlFrag+=")"}return urlFrag}},{key:"_getRouterElements",value:function _getRouterElements(tagName){var routeElements=[];tagName=tagName.toLowerCase();for(var i=0,iLen=this.children.length,elem;i<iLen;i++){elem=this.children[i];if(elem.tagName.toLowerCase()===tagName){routeElements.push(elem)}}return routeElements}}],[{key:"initialize",value:function initialize(){if(!RouterElement._initialized){RouterElement._initialized=!0;RouterElement._activeRouters=[];RouterElement._anchors=[];RouterElement._route={};RouterElement._routers=[];RouterElement._encodeSpaceAsPlusInQuery=!1;RouterElement._dwellTime=2e3;window.addEventListener("popstate",RouterElement.changeUrl,!1);window.addEventListener("click",RouterElement.navigate,!1);window.addEventListener("onRouterAdded",RouterElement.handlerAddRouter.bind(RouterElement),!1);window.addEventListener("routerLinksAdded",RouterElement.handlerRouterLinksAdded.bind(RouterElement),!1);window.addEventListener("navigate",RouterElement.handlerNavigate.bind(RouterElement),!1);RouterElement.changeUrl(decodeURIComponent(location.pathname))}}},{key:"_getSameOriginLinkHref",value:function _getSameOriginLinkHref(hrefSource){var href=null,anchor=null;if(babelHelpers.instanceof(hrefSource,Event)){var event=hrefSource;if(0!==event.button){return null}if(event.metaKey||event.ctrlKey){return null}for(var eventPath=event.path,i=0,element;i<eventPath.length;i++){element=eventPath[i];if("A"===element.tagName&&element.href){anchor=element;break}}if(!anchor){return null}}else if("string"===typeof hrefSource){href=hrefSource}else{anchor=hrefSource}if(anchor){if("_blank"===anchor.target){return""}if(("_top"===anchor.target||"_parent"===anchor.target)&&window.top!==window){return""}if(anchor.download){return""}href=anchor.href}if(0!==href.indexOf(document.baseURI)){return""}var hrefEsacped=href.replace(/::/g,"$_$_"),url;if(null!=document.baseURI){url=new URL(hrefEsacped,document.baseURI)}else{url=new URL(hrefEsacped)}var origin;if(window.location.origin){origin=window.location.origin}else{origin=window.location.protocol+"//"+window.location.host}var urlOrigin;if(url.origin&&"null"!==url.origin){urlOrigin=url.origin}else{var urlHost=url.host,urlPort=url.port,urlProtocol=url.protocol,isExtraneousHTTPS="https:"===urlProtocol&&"443"===urlPort,isExtraneousHTTP="http:"===urlProtocol&&"80"===urlPort;if(isExtraneousHTTPS||isExtraneousHTTP){urlHost=url.hostname}urlOrigin=urlProtocol+"//"+urlHost}if(urlOrigin!==origin){return""}var normalizedHref=url.pathname.replace(/\$_\$_/g,"::")+url.search.replace(/\$_\$_/g,"::")+url.hash.replace(/\$_\$_/g,"::");if("/"!==normalizedHref[0]){normalizedHref="/"+normalizedHref}var urlSpaceRegExp=RouterElement._makeRegExp(RouterElement.whiteListRegEx);if(urlSpaceRegExp&&!urlSpaceRegExp.test(normalizedHref)){return""}var fullNormalizedHref=new URL(normalizedHref,window.location.href).href;return fullNormalizedHref}},{key:"_makeRegExp",value:function _makeRegExp(urlSpaceRegex){return RegExp(urlSpaceRegex)}},{key:"_getHash",value:function _getHash(){return window.decodeURIComponent(window.location.hash.substring(1))}},{key:"baseUrlSansHost",value:function baseUrlSansHost(){var host=window.location.protocol+"//"+window.location.host;return document.baseURI.substr(host.length+1)}},{key:"_getUrl",value:function _getUrl(url){url=url||window.location;var path=window.decodeURIComponent(url.pathname),query=url.search.substring(1),hash=RouterElement._getHash(url),partiallyEncodedPath=window.encodeURI(path).replace(/\#/g,"%23").replace(/\?/g,"%3F"),partiallyEncodedQuery="";if(query){partiallyEncodedQuery="?"+query.replace(/\#/g,"%23");if(RouterElement._encodeSpaceAsPlusInQuery){partiallyEncodedQuery=partiallyEncodedQuery.replace(/\+/g,"%2B").replace(/ /g,"+").replace(/%20/g,"+")}else{partiallyEncodedQuery=partiallyEncodedQuery.replace(/\+/g,"%2B").replace(/ /g,"%20")}}var partiallyEncodedHash="";if(hash){partiallyEncodedHash="#"+window.encodeURI(hash)}return partiallyEncodedPath+partiallyEncodedQuery+partiallyEncodedHash}}]);return RouterElement}(babelHelpers.wrapNativeSuper(HTMLElement));RouterElement.assignedOutlets={};window.customElements.define("a-router",RouterElement);var routesRouter={RouterElement:RouterElement},RouteElement=function(_HTMLElement2){babelHelpers.inherits(RouteElement,_HTMLElement2);babelHelpers.createClass(RouteElement,[{key:"connectedCallback",value:function connectedCallback(){if(!this.created){this.created=!0;this.style.display="none";var baseElement=document.head.querySelector("base");this.baseUrl=baseElement&&baseElement.getAttribute("href")}if(this.isConnected){var initMatch=function initMatch(){this.parentNode&&this.parentNode.addRoute&&this.parentNode.addRoute(this)};setTimeout(initMatch.bind(this),0);if(this.hasAttribute("lazyload")&&"true"!==this.getAttribute("lazyload").toLowerCase()){var importAttr=this.getAttribute("import"),tagName=this.getAttribute("element");if(importAttr&&customElements.get(tagName)===void 0){import(importAttr)}}}}},{key:"disconnectedCallback",value:function disconnectedCallback(){this.parentNode&&this.parentNode.isConnected&&this.parentNode.removeRoute(this)}}]);function RouteElement(){var _this2;babelHelpers.classCallCheck(this,RouteElement);_this2=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(RouteElement).call(this));_this2.canLeave=NamedRouting.canLeave.bind(babelHelpers.assertThisInitialized(babelHelpers.assertThisInitialized(_this2)));return _this2}babelHelpers.createClass(RouteElement,[{key:"_createPathSegments",value:function _createPathSegments(url){return url.replace(/(^\/+|\/+$)/g,"").split("/")}},{key:"match",value:function match(url){var urlSegments=this._createPathSegments(url),path=this.getAttribute("path");if(!path){console.log("route must contain a path");throw"Route has no path defined. Add a path attribute to route"}var match=null;if("*"===path){match={url:url,remainder:"",data:null}}else if(path===url){match={url:url,remainder:"",data:null}}else{for(var pathSegments=this._createPathSegments(path),data=new Map,max=Math.max(urlSegments.length,pathSegments.length),ret,i=0;i<max;i++){if(pathSegments[i]&&":"===pathSegments[i].charAt(0)){var param=pathSegments[i].replace(/(^\:|[+*?]+$)/g,""),flags=(pathSegments[i].match(/[+*?]+$/)||[])[0]||"",plus=~flags.indexOf("+"),star=~flags.indexOf("*"),val=urlSegments[i]||"";if(!val&&!star&&(0>flags.indexOf("?")||plus)){match=null;break}data.set(param,decodeURIComponent(val));if(plus||star){data.set(param,urlSegments.slice(i).map(decodeURIComponent).join("/"));match={url:url,remainder:"",data:data};break}}else if(pathSegments[i]!==urlSegments[i]){if(0<i&&!this.hasAttribute("fullmatch")){match={url:urlSegments.slice(0,i).join("/"),remainder:urlSegments.slice(i).join("/"),data:data}}break}if(i===max-1){match={url:url,remainder:"",data:data}}}}if(null!==match){var routeMatchedEvent=new CustomEvent("onRouteMatch",{bubbles:!0,cancelable:!0,composed:!0,detail:{route:this,match:match,path:path}});this.dispatchEvent(routeMatchedEvent);if(routeMatchedEvent.defaultPrevented){match=null}if(this.hasAttribute("redirect")){match.redirect=this.getAttribute("redirect")}}if(match){var useCache=this.lastMatch&&this.lastMatch.url===match.url&&!this.hasAttribute("disableCache");match.useCache=useCache}this.lastMatch=match;return match}},{key:"getContent",value:function(){var _getContent=babelHelpers.asyncToGenerator(regeneratorRuntime.mark(function _callee(){var attributes,content,importAttr,tagName,template,_args=arguments;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:attributes=0<_args.length&&_args[0]!==void 0?_args[0]:{};content=this.content;if(content){_context.next=11;break}importAttr=this.getAttribute("import");tagName=this.getAttribute("element");_context.next=7;return RouteElement.importCustomElement(importAttr,tagName);case 7:if(tagName){content=document.createElement(tagName)}template=this.children[0];if(!(template&&"TEMPLATE"===template.nodeName)){_context.next=11;break}return _context.abrupt("return",template.content.cloneNode(!0));case 11:RouteElement.setData(content,attributes);return _context.abrupt("return",this.content=content);case 13:case"end":return _context.stop();}}},_callee,this)}));function getContent(){return _getContent.apply(this,arguments)}return getContent}()}],[{key:"importCustomElement",value:function(){var _importCustomElement=babelHelpers.asyncToGenerator(regeneratorRuntime.mark(function _callee2(importSrc,tagName){return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(importSrc&&customElements.get(tagName)===void 0)){_context2.next=3;break}_context2.next=3;return import(importSrc);case 3:case"end":return _context2.stop();}}},_callee2,this)}));function importCustomElement(_x,_x2){return _importCustomElement.apply(this,arguments)}return importCustomElement}()},{key:"setData",value:function setData(target,data){data.forEach(function(v,k){if("."===k[0]){target[k.substr(1)]=v}else{target.setAttribute(k,v)}})}}]);return RouteElement}(babelHelpers.wrapNativeSuper(HTMLElement));window.customElements.define("a-route",RouteElement);var routesRoute={RouteElement:RouteElement},OutletElement=function(_HTMLElement3){babelHelpers.inherits(OutletElement,_HTMLElement3);babelHelpers.createClass(OutletElement,[{key:"connectedCallback",value:function connectedCallback(){if(this.isConnected){if(!this.created){this.created=!0;NamedRouting.addNamedItem(this)}RouterElement.initialize()}}},{key:"disconnectedCallback",value:function disconnectedCallback(){if(this.getName()){NamedRouting.removeNamedItem(this.getName())}}}],[{key:"deserializeDataFromUrl",value:function deserializeDataFromUrl(urlData){var match=urlData.match(/^([\w-]+)(\(.*?\))?(?:\:(.+))?/);if(match){var data=new Map;if(match[3]){for(var keyValues=match[3].split("&"),i=0,iLen=keyValues.length,keyValue;i<iLen;i++){keyValue=keyValues[i].split("=");data.set(decodeURIComponent(keyValue[0]),decodeURIComponent(keyValue[1]))}}var elementTag=match[1],importPath=match[2]&&match[2].substr(1,match[2].length-2),options={import:importPath};return{elementTag:elementTag,data:data,options:options}}}}]);function OutletElement(){var _this3;babelHelpers.classCallCheck(this,OutletElement);_this3=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(OutletElement).call(this));_this3.canLeave=NamedRouting.canLeave.bind(babelHelpers.assertThisInitialized(babelHelpers.assertThisInitialized(_this3)));return _this3}babelHelpers.createClass(OutletElement,[{key:"getName",value:function getName(){if(this.outletName===void 0){this.outletName=this.getAttribute("name")}return this.outletName}},{key:"_createPathSegments",value:function _createPathSegments(url){return url.replace(/(^\/+|\/+$)/g,"").split("/")}},{key:"renderContent",value:function renderContent(content){this.innerHTML="";if("string"===typeof content||babelHelpers.instanceof(content,String)){this.innerHTML=content}else{this.appendChild(content)}this.dispatchOuletUpdated()}},{key:"processNamedUrl",value:function(){var _processNamedUrl=babelHelpers.asyncToGenerator(regeneratorRuntime.mark(function _callee3(url,supressUrlGeneration){var details,options,data,element;return regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:details=OutletElement.deserializeDataFromUrl(url);options=details.options||{};data=details.data||new Map;if(!1===babelHelpers.instanceof(data,Map)){data=new Map(Object.entries(data||{}))}if(!(this.children&&this.children[0]&&this.children[0].tagName.toLowerCase()==details.elementTag)){_context3.next=8;break}RouteElement.setData(this.children[0],data||{});this.dispatchOuletUpdated();return _context3.abrupt("return",this.children[0]);case 8:_context3.next=10;return RouteElement.importCustomElement(options.import,details.elementTag);case 10:element=document.createElement(details.elementTag);RouteElement.setData(element,data||{});this.renderContent(element);if(!supressUrlGeneration){RouterElement.updateHistory("")}return _context3.abrupt("return",element);case 15:case"end":return _context3.stop();}}},_callee3,this)}));function processNamedUrl(_x3,_x4){return _processNamedUrl.apply(this,arguments)}return processNamedUrl}()},{key:"dispatchOuletUpdated",value:function dispatchOuletUpdated(){this.dispatchEvent(new CustomEvent("onOutletUpdated",{bubbles:!0,composed:!0,detail:{}}))}}]);return OutletElement}(babelHelpers.wrapNativeSuper(HTMLElement));window.customElements.define("an-outlet",OutletElement);export{namedRouting as $namedRouting,routesRoute as $routesRoute,routesRouter as $routesRouter,NamedRouting,RouteElement,RouterElement};